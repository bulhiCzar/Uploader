{"ast":null,"code":"var _jsxFileName = \"C:\\\\bulhi\\\\#work\\\\downloadFileServer\\\\client\\\\src\\\\pages\\\\UploadPage.js\";\nimport React, { useEffect, useState } from 'react';\nimport { useHttp } from '../hooks/http.hooks';\nimport modalInfo from '../modules/toast/main';\nimport './UploadPage.css';\n\nfunction UploadPage() {\n  const {\n    loading,\n    error,\n    request,\n    clearError\n  } = useHttp();\n  const [selectedFiles, setSelectedFiles] = useState([]);\n\n  const selectFile = event => {\n    console.log(event.target.files);\n    setSelectedFiles(event.target.files);\n  };\n\n  useEffect(() => {\n    load();\n    modalInfo(error);\n    clearError(null);\n  }, [error, clearError]);\n\n  function load() {\n    let dropArea = document.getElementById('drug-and-drop-media');\n    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {\n      dropArea.addEventListener(eventName, preventDefaults, false);\n    });\n\n    function preventDefaults(e) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n\n    ['dragenter', 'dragover'].forEach(eventName => {\n      dropArea.addEventListener(eventName, highlight, false);\n    });\n    ['dragleave', 'drop'].forEach(eventName => {\n      dropArea.addEventListener(eventName, unhighlight, false);\n    });\n\n    function highlight(e) {\n      dropArea.classList.add('highlight');\n    }\n\n    function unhighlight(e) {\n      dropArea.classList.remove('highlight');\n    }\n\n    dropArea.addEventListener('drop', handleDrop, false);\n\n    function handleDrop(e) {\n      let dt = e.dataTransfer;\n      let files = dt.files;\n      handleFiles(files);\n    }\n\n    function handleFiles(files) {\n      files.forEach(uploadFile);\n    }\n\n    function uploadFile(file) {\n      var url = 'api/file/upload';\n      var xhr = new XMLHttpRequest();\n      var formData = new FormData();\n      xhr.open('POST', url, true);\n      xhr.addEventListener('readystatechange', function (e) {\n        if (xhr.readyState == 4 && xhr.status == 200) {// Готово. Информируем пользователя\n        } else if (xhr.readyState == 4 && xhr.status != 200) {// Ошибка. Информируем пользователя\n        }\n      });\n      formData.append('file', file);\n      xhr.send(formData);\n    }\n  }\n\n  async function uploadSubmit(e) {\n    e.preventDefault(); // console.log(selectedFiles[0])\n\n    const info = {\n      name: selectedFiles[0].name,\n      lastModified: selectedFiles[0].lastModified,\n      size: selectedFiles[0].size,\n      type: selectedFiles[0].type\n    };\n\n    try {\n      const data = await request('/api/file/test', 'POST', info, {\n        'Content-Type': 'multipart/form-data'\n      });\n      console.log(data);\n    } catch (error) {}\n  }\n\n  return (\n    /*#__PURE__*/\n    // <form onSubmit={uploadSubmit}  id=\"upload-container\" >\n    //     <script src=\"https://code.jquery.com/jquery-3.5.1.slim.js\"></script>\n    //     <img id=\"upload-image\" src=\"https://habrastorage.org/webt/dr/qg/cs/drqgcsoh1mosho2swyk3kk_mtwi.png\" />\n    //     <div>\n    //         <input id=\"file-input\" type=\"file\" name=\"file\" multiple onChange={selectFile}/>\n    //         <label htmlFor=\"file-input\">Выберите файл</label>\n    //         <span>или перетащите его сюда</span>\n    //         {/* <input type=\"file\" id=\"getFiles\" multiple  /> */}\n    //     </div>\n    //     <button type=\"submit\" name=\"file\" disabled={loading}>Обработать</button>\n    // </form>\n    React.createElement(\"div\", {\n      id: \"drug-and-drop-media\",\n      class: \"d-flex flex-column justify-content-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }\n    }, \"\\u041C\\u0435\\u0434\\u0438\\u0439\\u043D\\u044B\\u0439 \\u043A\\u043E\\u043D\\u0442\\u0435\\u043D\\u0442\", /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 29\n      }\n    }), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"file\",\n      id: \"fileElem\",\n      multiple: true,\n      accept: \"image/*\",\n      onchange: handleFiles(this.files),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      class: \"button align-self-center\",\n      htmlFor: \"fileElem\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 13\n      }\n    }, \"\\u0412\\u044B\\u0431\\u0440\\u0430\\u0442\\u044C \\u0444\\u0430\\u0439\\u043B\"))\n  );\n}\n\nexport default UploadPage;","map":{"version":3,"sources":["C:/bulhi/#work/downloadFileServer/client/src/pages/UploadPage.js"],"names":["React","useEffect","useState","useHttp","modalInfo","UploadPage","loading","error","request","clearError","selectedFiles","setSelectedFiles","selectFile","event","console","log","target","files","load","dropArea","document","getElementById","forEach","eventName","addEventListener","preventDefaults","e","preventDefault","stopPropagation","highlight","unhighlight","classList","add","remove","handleDrop","dt","dataTransfer","handleFiles","uploadFile","file","url","xhr","XMLHttpRequest","formData","FormData","open","readyState","status","append","send","uploadSubmit","info","name","lastModified","size","type","data"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { useHttp } from '../hooks/http.hooks'\r\nimport modalInfo from '../modules/toast/main'\r\nimport './UploadPage.css'\r\n\r\n\r\n\r\nfunction UploadPage() {\r\n    const { loading, error, request, clearError } = useHttp()\r\n\r\n    const [selectedFiles, setSelectedFiles] = useState([])\r\n\r\n    const selectFile = (event) => {\r\n        console.log(event.target.files)\r\n        setSelectedFiles(event.target.files)\r\n    }\r\n\r\n    useEffect(() => {\r\n        load()\r\n        modalInfo(error)\r\n        clearError(null)\r\n    }, [error, clearError])\r\n\r\n    function load() {\r\n        let dropArea = document.getElementById('drug-and-drop-media');\r\n\r\n        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {\r\n            dropArea.addEventListener(eventName, preventDefaults, false);\r\n        });\r\n\r\n        function preventDefaults(e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        }\r\n\r\n        ['dragenter', 'dragover'].forEach(eventName => {\r\n            dropArea.addEventListener(eventName, highlight, false);\r\n        });\r\n\r\n        ['dragleave', 'drop'].forEach(eventName => {\r\n            dropArea.addEventListener(eventName, unhighlight, false);\r\n        });\r\n\r\n        function highlight(e) {\r\n            dropArea.classList.add('highlight');\r\n        }\r\n        function unhighlight(e) {\r\n            dropArea.classList.remove('highlight');\r\n        }\r\n\r\n\r\n        dropArea.addEventListener('drop', handleDrop, false);\r\n        function handleDrop(e) {\r\n            let dt = e.dataTransfer;\r\n            let files = dt.files;\r\n            handleFiles(files);\r\n        }\r\n\r\n        function handleFiles(files) {\r\n            files.forEach(uploadFile);\r\n        }\r\n\r\n        function uploadFile(file) {\r\n\r\n            var url = 'api/file/upload';\r\n            var xhr = new XMLHttpRequest();\r\n            var formData = new FormData();\r\n\r\n            xhr.open('POST', url, true);\r\n            xhr.addEventListener('readystatechange', function (e) {\r\n                if (xhr.readyState == 4 && xhr.status == 200) {\r\n                    // Готово. Информируем пользователя\r\n                }\r\n                else if (xhr.readyState == 4 && xhr.status != 200) {\r\n                    // Ошибка. Информируем пользователя\r\n                }\r\n            });\r\n\r\n            formData.append('file', file);\r\n            xhr.send(formData);\r\n        }\r\n    }\r\n\r\n    async function uploadSubmit(e) {\r\n        e.preventDefault()\r\n        // console.log(selectedFiles[0])\r\n        const info = {\r\n            name: selectedFiles[0].name,\r\n            lastModified: selectedFiles[0].lastModified,\r\n            size: selectedFiles[0].size,\r\n            type: selectedFiles[0].type\r\n        }\r\n        try {\r\n            const data = await request('/api/file/test', 'POST', info, { 'Content-Type': 'multipart/form-data' })\r\n            console.log(data)\r\n        } catch (error) { }\r\n    }\r\n\r\n\r\n    return (\r\n        // <form onSubmit={uploadSubmit}  id=\"upload-container\" >\r\n        //     <script src=\"https://code.jquery.com/jquery-3.5.1.slim.js\"></script>\r\n        //     <img id=\"upload-image\" src=\"https://habrastorage.org/webt/dr/qg/cs/drqgcsoh1mosho2swyk3kk_mtwi.png\" />\r\n        //     <div>\r\n        //         <input id=\"file-input\" type=\"file\" name=\"file\" multiple onChange={selectFile}/>\r\n        //         <label htmlFor=\"file-input\">Выберите файл</label>\r\n        //         <span>или перетащите его сюда</span>\r\n        //         {/* <input type=\"file\" id=\"getFiles\" multiple  /> */}\r\n        //     </div>\r\n        //     <button type=\"submit\" name=\"file\" disabled={loading}>Обработать</button>\r\n        // </form>\r\n        <div id=\"drug-and-drop-media\" class=\"d-flex flex-column justify-content-center\">\r\n            Медийный контент<br />\r\n            <input type=\"file\" id=\"fileElem\" multiple accept=\"image/*\" onchange={handleFiles(this.files)} />\r\n            <label class=\"button align-self-center\" htmlFor=\"fileElem\">Выбрать файл</label>\r\n        </div>\r\n\r\n    )\r\n}\r\n\r\nexport default UploadPage"]},"metadata":{},"sourceType":"module"}